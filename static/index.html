<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vida - 视频应用</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iNDAiIGZpbGw9IiMwMDdiZmYiLz4KPGNpcmNsZSBjeD0iNzIiIGN5PSI4NCIgcj0iMTYiIGZpbGw9IndoaXRlIi8+CjxyZWN0IHg9IjU4IiB5PSIxMTIiIHdpZHRoPSIyOCIgaGVpZ2h0PSI4IiByeD0iNCIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEyMCA4NCBMMTQwIDEwMCBMMTIwIDExNiBaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4=">
</head>
<body>
    <div id="app">
        <!-- 导航栏 -->
        <nav class="navbar">
            <div class="nav-content">
                <div class="nav-brand">
                    <i class="fas fa-video"></i>
                    <span>Vida</span>
                </div>
                <div class="nav-search">
                    <input type="text" placeholder="搜索视频..." id="searchInput" onkeypress="handleSearchKeyPress(event)">
                    <i class="fas fa-search" onclick="performSearch()" style="cursor: pointer;"></i>
                </div>
                <div class="nav-actions">
                    <button class="btn btn-outline" onclick="showAgentChatModal()" title="AI助手">
                        <i class="fas fa-robot"></i> AI助手
                    </button>
                    <button class="btn btn-outline" onclick="showUploadModal()">
                        <i class="fas fa-upload"></i> 上传视频
                    </button>
                    <div class="user-menu" id="userMenu" style="display: none;">
                        <img src="" alt="头像" class="avatar" id="userAvatar" style="cursor: pointer;" onclick="toggleUserMenu()">
                        <span id="userName" style="cursor: pointer;" onclick="toggleUserMenu()"></span>
                        <div class="dropdown" id="userDropdown" style="display: none;">
                            <a href="#" onclick="showMyProfile(); return false;"><i class="fas fa-user"></i> 个人主页</a>
                            <a href="#" onclick="showMyVideos(); return false;"><i class="fas fa-video"></i> 我的视频</a>
                            <a href="#" onclick="showFavorites(); return false;"><i class="fas fa-heart"></i> 我的点赞</a>
                            <a href="#" onclick="showFollowing(); return false;"><i class="fas fa-user-friends"></i> 关注管理</a>
                            <hr>
                            <a href="#" onclick="logout(); return false;"><i class="fas fa-sign-out-alt"></i> 退出登录</a>
                        </div>
                    </div>
                    <button id="loginBtn" class="btn btn-primary" onclick="showLoginModal()">登录</button>
                </div>
            </div>
        </nav>

        <!-- 主要内容区 -->
        <main class="main-content">
            <!-- 视频流区域 -->
            <div class="video-feed" id="videoFeed">
                <h2 class="section-title"></h2>
                <div class="video-grid" id="videoGrid">
                    <!-- 视频将通过 JavaScript 动态加载 -->
                </div>
                <div class="loading" id="loading" style="display: none;">
                    <div class="spinner"></div>
                    <span>加载中...</span>
                </div>
            </div>
        </main>

        <!-- 浮动按钮 -->
        <button class="fab-btn" onclick="showUploadModal()">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <!-- 登录模态框 -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>用户登录</h3>
                <span class="close" onclick="closeModal('loginModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="loginForm" onsubmit="login(event)">
                    <div class="form-group">
                        <label for="loginUsername">用户名</label>
                        <input type="text" id="loginUsername" required placeholder="请输入用户名">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">密码</label>
                        <input type="password" id="loginPassword" required placeholder="请输入密码">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">登录</button>
                </form>
                <p class="text-center">还没有账号？<a href="#" onclick="showRegisterModal()">立即注册</a></p>
            </div>
        </div>
    </div>

    <!-- 注册模态框 -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>用户注册</h3>
                <span class="close" onclick="closeModal('registerModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="registerForm" onsubmit="register(event)">
                    <div class="form-group">
                        <label for="registerUsername">用户名</label>
                        <input type="text" id="registerUsername" required placeholder="请输入用户名">
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">密码</label>
                        <input type="password" id="registerPassword" required placeholder="请输入密码">
                    </div>
                    <div class="form-group">
                        <label for="registerConfirmPassword">确认密码</label>
                        <input type="password" id="registerConfirmPassword" required placeholder="请再次输入密码">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">注册</button>
                </form>
                <p class="text-center">已有账号？<a href="#" onclick="showLoginModal()">立即登录</a></p>
            </div>
        </div>
    </div>

    <!-- 上传视频模态框 -->
    <div class="modal" id="uploadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>上传视频</h3>
                <span class="close" onclick="closeModal('uploadModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="uploadForm" onsubmit="uploadVideo(event)">
                    <div class="form-group">
                        <label for="videoFile">选择视频文件</label>
                        <input type="file" id="videoFile" accept="video/*" required>
                        <small class="form-text">支持格式：MP4, AVI, MOV, MKV, FLV, WebM (最大500MB)</small>
                    </div>
                    <div class="form-group">
                        <label for="videoTitle">视频标题</label>
                        <input type="text" id="videoTitle" required placeholder="请输入视频标题">
                    </div>
                    <div class="form-group">
                        <label for="videoDescription">视频描述</label>
                        <textarea id="videoDescription" rows="3" placeholder="请输入视频描述"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">开始上传</button>
                </form>
            </div>
        </div>
    </div>

    <!-- 视频详情模态框 -->
    <div class="modal modal-large" id="videoDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="detailTitle">视频详情</h3>
                <span class="close" onclick="closeModal('videoDetailModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="video-detail" id="videoDetailContent">
                    <!-- 视频详情通过 JavaScript 动态加载 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 个人资料模态框 -->
    <div class="modal modal-large" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="profileTitle">个人资料</h3>
                <span class="close" onclick="closeModal('profileModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="profile-detail" id="profileContent">
                    <!-- 个人资料通过 JavaScript 动态加载 -->
                </div>
            </div>
        </div>
    </div>

    <!-- Agent对话模态框 -->
    <div class="modal modal-large" id="agentChatModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-robot"></i> AI助手</h3>
                <span class="close" onclick="closeModal('agentChatModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="chat-container" id="chatContainer">
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message bot-message">
                            <div class="message-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="message-content">
                                <p>你好！我是AI助手，可以帮助你搜索视频。你可以问我："帮我找一些搞笑的视频" 或 "搜索Python教程" 等。</p>
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="chatInput" placeholder="输入你的问题..." onkeypress="handleChatKeyPress(event)">
                        <button class="btn btn-primary" onclick="sendChatMessage()" id="sendChatBtn">
                            <i class="fas fa-paper-plane"></i> 发送
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
    <script src="js/ui.js"></script>
</body>
</html>